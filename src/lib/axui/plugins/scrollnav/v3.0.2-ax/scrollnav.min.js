/*!
* 插件：scrollnav；使用方法：scrollnav.init('#id',{参数})
* AXUI改版
* 1、插件中的样式均增加ax-前缀，样式中的下划线_均替换为了短横线-。
* 2、支持两级锚点菜单，分别是h2和h3。
* 3、修改了默认参数insertLocation为append。
*/
const t=document.querySelectorAll(".ax-scrollnav-v");for(let e=0;e<t.length;e++){let n=t[e],i=n.querySelector(".ax-close");i&&i.addEventListener("click",()=>{n.classList.contains("ax-hide")?(n.classList.remove("ax-hide"),axCookie.set("scrollnav","show")):(n.classList.add("ax-hide"),axCookie.set("scrollnav","hide"))},!1),"hide"===axCookie.get("scrollnav")?n.classList.add("ax-hide"):n.classList.remove("ax-hide")}!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.scrollnav=e()}(this,(function(){function t(t,e){var n,i={};for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i}function e(t,e){if("object"!=typeof t)return Promise.reject(new Error("First argument must be an object"));if("object"!=typeof(e=e||document.body))return Promise.reject(new Error("Second argument must be an object"));var n=e.getBoundingClientRect();return t.getBoundingClientRect().top-n.top}function n(t,i,s){void 0===s&&(s="ax-scrollnav");var r=[];return s+="-",t.forEach((function(t,o){var a=[],u=function(t,e){if("object"!=typeof t)return Promise.reject(new Error("First argument must be an object"));var n=t.id;if(!n){if("string"!=typeof e)return Promise.reject(new Error("Second argument must be a string"));t.id=n=e}return n}(t,s+(o+1));i.subSections&&t.matches(i.sections)&&(a=n(function(t,e,n){var i=[];for(t=t.nextElementSibling;t&&!t.matches(e);)!n||t.matches(n)?(i.push(t),t=t.nextElementSibling):t=t.nextElementSibling;return i}(t,i.sections,i.subSections),i,u)),r.push({id:u,text:t.innerText||t.textContent,offsetTop:e(t),subSections:a})})),r}function i(t){return t.forEach((function(t){var n=document.querySelector("#"+t.id);t.offsetTop=e(n),t.subSections.length&&(t.subSections=i(t.subSections))})),t}var s,r,o,a=function(t){return function(e){return Math.pow(e,t)}},u=function(t){return function(e){return 1-Math.abs(Math.pow(e-1,t))}},c=function(t){return function(e){return e<.5?a(t)(2*e)/2:u(t)(2*e-1)/2+.5}},l={linear:c(1),easeInQuad:a(2),easeOutQuad:u(2),easeInOutQuad:c(2),easeInCubic:a(3),easeOutCubic:u(3),easeInOutCubic:c(3),easeInQuart:a(4),easeOutQuart:u(4),easeInOutQuart:c(4),easeInQuint:a(5),easeOutQuint:u(5),easeInOutQuint:c(5)};function d(t,e){return new Promise((function(n,i){if("number"!=typeof t)return i(new Error("First argument must be a number"));if("string"!=typeof(e=e||"linear"))return i(new Error("Second argument must be a string"));var s,r=window.pageYOffset,o=t-r,a=function(t){var e=Math.abs(t/2);return Math.min(Math.max(e,250),1200)}(o),u=0;!function t(){s=l[e]((u+=20)/a),window.scroll(0,s*o+r),u<a?setTimeout(t,20):n(window.pageYOffset)}()}))}function f(t){return t instanceof Element}return{init:function(e,a){if(this.settings=t({sections:"h2",subSections:"h3",insertTarget:e,insertLocation:"append",easingStyle:"easeOutQuad",updateHistory:!0},a),f(e))if(!this.settings.insertTarget||f(this.settings.insertTarget))if(["append","prepend","after","before"].includes(this.settings.insertLocation)){var u,c,l,h,v=e.querySelectorAll(this.settings.sections);if(v.length)return this.data=n(v,this.settings),this.nav=function(t){var e=document.createElement("div");return e.className="ax-scrollnav",e.innerHTML=function t(e,n){void 0===n&&(n=!1);var i="ax-scrollnav"+(n?"-sub-":"-"),s="\n    "+e.map((function(e){return'<li class="'+i+'item" data-section="'+e.id+'">\n            <a class="'+i+'link" href="#'+e.id+'">'+e.text+"</a>\n            "+(e.subSections&&e.subSections.length?""+t(e.subSections,!0):"")+"\n          </li>"})).join("")+"\n  ";return'\n    <ol class="'+i+'list">\n      '+s+"\n    </ol>\n "}(t),e}(this.data),c=(u=this).settings.insertTarget,"append"===(l=u.settings.insertLocation)?c.appendChild(u.nav):"prepend"===l?c.insertBefore(u.nav,c.firstChild):"before"===l?c.parentNode.insertBefore(u.nav,c):"after"===l&&c.parentNode.insertBefore(u.nav,c.nextSibling),s=function(t){var e=t.settings;function n(n){n.preventDefault();var i=.39*window.innerHeight;return d(function(t,e){var n=t.getAttribute("href");return"#"===n.charAt(0)&&(n=n.substr(1)),function t(e,n){var i;return e.forEach((function(e){e.id===n&&(i=e),e.subSections&&void 0===i&&(i=t(e.subSections,n))})),i}(e,n).offsetTop}(n.target,t.data)-i,e.easingStyle).then((function(){e.updateHistory&&history.replaceState({},"",n.target.getAttribute("href")),e.onScroll&&e.onScroll()}))}return t.nav.querySelectorAll("a").forEach((function(t){t.addEventListener("click",n)})),n}(this),r=function(t){function e(){var e=window.scrollY||window.pageYOffset||document.body.scrollTop,n=e+.4*window.innerHeight,i=function t(e,n,i){var s,r;return e.forEach((function(t){t.offsetTop>i?!s&&t.offsetTop<n&&(s=t):s=t})),s&&s.subSections.length&&(r=t(s.subSections,n,i))&&(s=r),s}(t.data,e,n);return function(t,e){var n=e.querySelector("[data-active]");if(t){var i=e.querySelector("[data-section="+t.id+"]");i&&i!==n&&(n&&(n.classList.remove("ax-active"),n.removeAttribute("data-active")),i.classList.add("ax-active"),i.setAttribute("data-active",!0))}else n&&(n.classList.remove("ax-active"),n.removeAttribute("data-active"))}(i,t.nav),i}return window.addEventListener("scroll",e),e}(this),o=function(t){function e(){t.data=i(t.data)}return window.addEventListener("resize",e),e}(this),this.settings.debug&&((h=document.createElement("div")).className="snDebugger",h.setAttribute("style","\n      position: fixed;\n      top: 40%;\n      height: 0px;\n      border-bottom:5px solid red;\n      border-top: 5px solid blue;\n      width: 100%;\n      opacity: .5;\n      pointer-events: none;\n    "),document.body.appendChild(h)),this.settings.onInit?this.settings.onInit():void 0;this.settings.debug&&console.error('\n        scrollnav build failed, could not find any "'+this.settings.sections+'"\n        elements inside of "'+e+'"\n      ')}else this.settings.debug&&console.error('\n        scrollnav build failed, options.insertLocation "'+this.settings.insertLocation+'" is not a valid option\n      ');else this.settings.debug&&console.error('\n        scrollnav build failed, options.insertTarget "'+e+'" is not an HTML Element\n      ');else this.settings.debug&&console.error('\n        scrollnav build failed, content argument "'+e+'" is not an HTML Element\n      ')},destroy:function(e){if(this.settings=t(this.settings,e),function(t,e){t.querySelectorAll("a").forEach((function(t){t.removeEventListener("click",e)}))}(this.nav,s),function(t){window.removeEventListener("scroll",t)}(r),function(t){window.removeEventListener("resize",t)}(o),this.nav.remove(),this.settings.onDestroy)return this.settings.onDestroy()},updatePositions:function(e){if(this.settings=t(this.settings,e),this.data=i(this.data),this.settings.onUpdatePositions)return this.settings.onUpdatePositions()}}}));